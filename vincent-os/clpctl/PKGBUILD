# Maintainer: Florian. M <florian.m@v38armageddon.net>
pkgname="clpctl"
pkgver=2.0.0
pkgrel=2
pkgdesc="CLI Interface for Core LivePatch"
url="https://github.com/Vincent-OS/clpctl"
license=("MS-PL")
arch=('x86_64')
depends=(
    'dotnet-runtime-8.0'
    'powershell-bin'
)
source=(
    "https://github.com/Vincent-OS/clpctl/releases/download/v2.0/clpctl"
    "core-livepatch-update.service"
    "core-livepatch-update.timer"
    "90-core-livepatch.hook"
)
sha256sums=('43ddf84579048f60e4ab694a1875623e33f49cb07d62efff0219b2d666f208d3'
            'cb5ec6b46074d692bf2c3600aadf0984ef4964841d29ef35f2d7d973c406c3e9'
            '96f53c5c9b4b61b8241f6b5f1fdf8c137db46bfa8a68c3e74319e9515cf2e9a8'
            '268fc7c95e72045f9f7db3c1f364869d926ad2e312b1d5f09ddd995ff3468aec')
options=(!strip)

package() {
    mkdir -p "$pkgdir/etc/CLP"
    mkdir -p "$pkgdir/opt/CLP"
    install -Dm755 "clpctl" "$pkgdir/usr/bin/clpctl"
    install -Dm644 "core-livepatch-update.service" "$pkgdir/usr/lib/systemd/system/core-livepatch-update.service"
    install -Dm644 "core-livepatch-update.timer" "$pkgdir/usr/lib/systemd/system/core-livepatch-update.timer"
    install -Dm644 "90-core-livepatch.hook" "$pkgdir/usr/share/libalpm/hooks/90-core-livepatch.hook"
}
